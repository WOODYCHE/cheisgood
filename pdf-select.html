<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>選擇考古題觀看</title>
  <script>
    function loadPDFOptions() {
      // 讀取權限資料
      const permissions = JSON.parse(localStorage.getItem('permissions'));
      const container = document.getElementById('answerContainer');
      
      // 如果用戶沒有權限資料，跳回登入頁
      if (!permissions) {
        alert("您無權訪問此頁面，請先登入！");
        window.location.href = 'index.html';  // 跳回登入頁
        return;
      }

      // 定義考古題清單
      const subjects = [
        { name: "台大", file: "台大全部.pdf" },
        { name: "清大", file: "清大全部.pdf" },
        { name: "成大", file: "成大全部.pdf" },
        { name: "台科", file: "台科大全部.pdf" },
        { name: "中央", file: "中央全部.pdf" },
        { name: "中興", file: "中興全部.pdf" }
      ];

      // 根據權限顯示可訪問的 PDF 按鈕
      subjects.forEach(subject => {
        if (permissions[subject.name]) {  // 如果有權限
          let button = document.createElement('button');
          button.innerText = "觀看 " + subject.name + " 解答";
          button.onclick = function() { checkAccessAndShowPDF(subject.file); };
          container.appendChild(button);
        }
      });
    }

    // 檢查用戶是否有權限，然後顯示對應的 PDF
    function checkAccessAndShowPDF(pdfFile) {
      const permissions = JSON.parse(localStorage.getItem('permissions'));

      // 如果用戶沒有該 PDF 的權限，顯示錯誤並跳回登入頁
      if (!permissions || !permissions[pdfFile.replace('.pdf', '')]) {
        alert("您無權訪問此解答！");
        window.location.href = 'index.html';  // 無權訪問，跳回登入頁
      } else {
        window.location.href = `pdf-viewer.html?file=${pdfFile}`; // 具有權限，跳轉到 PDF 頁面
      }
    }

    window.onload = loadPDFOptions; // 頁面加載時顯示用戶可訪問的解答
  </script>
</head>
<body>
  <h2>選擇你要查看的考古題</h2>
  <div id="answerContainer"></div>
</body>
</html>
