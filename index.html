<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Facebook 社團專用 PDF 閱讀</title>
  <script>
    var urlParams = new URLSearchParams(window.location.search);
    var fbclid = urlParams.get('fbclid');  // 取得 Facebook 參數
    var referrer = document.referrer || "";  // 取得上一個訪問的網頁
    var userAgent = navigator.userAgent || navigator.vendor || window.opera; // 取得裝置資訊

    console.log("Referrer:", referrer);
    console.log("User Agent:", userAgent);
    console.log("fbclid:", fbclid);

    // **Step 1：強制阻擋 Messenger 或 Facebook 以外的來源**
    if (userAgent.includes("FBAN") || userAgent.includes("FBAV") || userAgent.includes("Messenger")) {
      window.location.href = "https://www.facebook.com/groups/667112409185609";  // Facebook 社團網址
    }

    // **Step 2：允許 Facebook 社團來源，或有 `fbclid` 就放行**
    if (referrer.includes("facebook.com/groups/667112409185609") || fbclid) {
      sessionStorage.setItem("fromFacebookGroup", "true");  // 記錄來自 Facebook 社團
    }

    // **Step 3：如果 `sessionStorage` 沒有 Facebook 來源，則跳轉回社團**
    if (!sessionStorage.getItem("fromFacebookGroup")) {
      window.location.href = "https://www.facebook.com/groups/667112409185609";  // Facebook 社團網址
    }

    // **Step 4：禁止右鍵、禁止開發者工具**
    document.addEventListener('contextmenu', event => event.preventDefault());

    document.addEventListener('keydown', function(event) {
      if ((event.ctrlKey && event.key === 's') || (event.ctrlKey && event.key === 'p')) {
        event.preventDefault();
        alert("禁止下載或列印此 PDF");
      }
      if (event.key === "F12" || (event.ctrlKey && event.shiftKey && event.key === "I")) {
        event.preventDefault();
        alert("禁止開發者工具！");
      }
    });

  </script>
</head>
<body>
  <h2>Facebook 社團專屬 PDF 閱讀</h2>
  <iframe 
    src="Sufficiency%20Proof%20at%20the%20Critical%20Point.pdf#toolbar=0&navpanes=0&scrollbar=0" 
    width="100%" 
    height="600px"
    style="border: none;"
  ></iframe>
</body>
</html>
